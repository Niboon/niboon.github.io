(function(factory){if(typeof define==="function"&&define.amd)define(["jquery","skel"],factory);else factory(jQuery,skel)})(function($,skel){skel.registerPlugin("layers",function($){if(typeof $=="undefined")return false;$.fn._skel_layers_demote=function(){if(this.length>1){for(var i=0;i<this.length;i++)$(this[i])._skel_layers_demote();return $(this)}var t=$(this);t.css("z-index",t.data("skel-layers-layer-z-index")).data("skel-layers-layer-z-index","");return t};$.fn._skel_layers_expandCell=function(){var t=$(this),p=t.parent(),diff=12;p.children().each(function(){var t=$(this),c=t.attr("class");if(c&&c.match(/(\s+|^)([0-9]+)u(\s+|$)/))diff-=parseInt(RegExp.$2)});if(diff>0){t._skel_layers_initializeCell();t.css("width",(t.data("cell-size")+diff)/12*100+"%")}};$.fn._skel_layers_hasParent=function(){return $(this).parents().length>0};$.fn._skel_layers_initializeCell=function(){var t=$(this);if(t.attr("class").match(/(\s+|^)([0-9]+)u(\s+|$)/))t.data("cell-size",parseInt(RegExp.$2))};$.fn._skel_layers_promote=function(n){if(this.length>1){for(var i=0;i<this.length;i++)$(this[i])._skel_layers_promote(n);return $(this)}var t=$(this),x;if(isNaN(x=parseInt(t.data("skel-layers-layer-index"))))x=0;t.data("skel-layers-layer-z-index",t.css("z-index")).css("z-index",_.config.baseZIndex+x+(n?n:1));return t};$.fn._skel_layers_resetForms=function(){var t=$(this);$(this).find("form").each(function(){this.reset()});return t};$.fn._skel_layers_xcss=function(p,v){return $(this).css(p,v).css("-moz-"+p,"-moz-"+v).css("-webkit-"+p,"-webkit-"+v).css("-o-"+p,"-o-"+v).css("-ms-"+p,"-ms-"+v)};$.fn._skel_layers_xcssProperty=function(p,v){return $(this).css(p,v).css("-moz-"+p,v).css("-webkit-"+p,v).css("-o-"+p,v).css("-ms-"+p,v)};$.fn._skel_layers_xcssValue=function(p,v){return $(this).css(p,v).css(p,"-moz-"+v).css(p,"-webkit-"+v).css(p,"-o-"+v).css(p,"-ms-"+v)};$.fn._skel_layers_uncss=function(){var $this=$(this),properties=$this.data("skel-layers-css"),values={};if(!properties||$this.data("skel-layers-css-values"))return $this;skel.iterate(properties,function(k){var x=$this.css(properties[k]);if(x){values[properties[k]]=x;$this.css(properties[k],"")}});$this.data("skel-layers-css-values",values)};$.fn._skel_layers_recss=function(){var $this=$(this),values=$this.data("skel-layers-css-values");if(!values)return $this;skel.iterate(values,function(property){$this.css(property,values[property])});$this.removeData("skel-layers-css-values")};function Layer(id,config,index){var a,x,_this=this;this.id=id;this.index=index;this.events={};this.config={breakpoints:null,states:null,position:null,side:null,animation:"none",orientation:"none",width:"auto",height:"auto",maxWidth:"100%",maxHeight:"100%",zIndex:this.index,html:"",hidden:false,exclusive:null,resetScroll:true,resetForms:true,swipeToHide:true,clickToHide:false};_._.extend(this.config,config);if(this.config.exclusive===null)this.config.exclusive=this.config.hidden;this.element=_._.newDiv(this.config.html);this.element.id=id;this.element._layer=this;this.$element=null;this.touchPosX=null;this.touchPosY=null;this.visible=false;x=_._.newElement(this.id,this.element,"skel_layers_hiddenWrapper",1);x.onAttach=function(){var layer=this.object._layer;if(!layer.isInitialized())layer.init();layer.resume()};x.onDetach=function(){var layer=this.object._layer;layer.suspend()};if(_this.config.states&&_this.config.states!=_._.sd){_._.cacheElement(x);a=_._.getArray(_this.config.states);_._.iterate(a,function(i){_._.addCachedElementToState(a[i],x)})}else if(_this.config.breakpoints){_._.cacheElement(x);a=_._.getArray(_this.config.breakpoints);_._.iterate(a,function(i){_._.addCachedElementToBreakpoint(a[i],x)})}else _._.attachElement(x)}Layer.prototype.animations={none:{show:function(layer){var config=layer.config,$le=layer.$element;$le.scrollTop(0)._skel_layers_promote(config.zIndex).show();if(config.resetForms)$le._skel_layers_resetForms();if(config.exclusive)_.lockView("x");layer.moveToVisibleWrapper();layer.trigger("showstart");layer.trigger("showend")},hide:function(layer){var config=layer.config,$le=layer.$element;$le.find("*").trigger("blur",[true]);if(config.exclusive)_.unlockView("x");layer.moveToHiddenWrapper();$le._skel_layers_demote().hide();layer.trigger("hidestart");layer.trigger("hideend")}},fade:{show:function(layer){var config=layer.config,$le=layer.$element;$le.scrollTop(0)._skel_layers_promote(config.zIndex).css("opacity",0).show();if(config.resetForms)$le._skel_layers_resetForms();if(config.exclusive)_.lockView("x");layer.moveToVisibleWrapper();layer.trigger("showstart");window.setTimeout(function(){$le._skel_layers_fadeIn(function(){layer.trigger("showend")})},50)},hide:function(layer){var config=layer.config,$le=layer.$element;$le.find("*").trigger("blur",[true]);layer.trigger("hidestart");$le._skel_layers_fadeOut(function(){if(config.exclusive)_.unlockView("x");layer.moveToHiddenWrapper();$le._skel_layers_demote().hide();layer.trigger("hideend")})}},overlayX:{show:function(layer){var config=layer.config,$le=layer.$element;$le.scrollTop(0)._skel_layers_promote(config.zIndex).css(config.side,"-"+_.recalcW(config._width)+"px").show();if(config.resetForms)$le._skel_layers_resetForms();if(config.exclusive)_.lockView("x");layer.moveToVisibleWrapper();layer.trigger("showstart");window.setTimeout(function(){$le._skel_layers_translate((config.side=="right"?"-":"")+_.recalcW(config._width),0);window.setTimeout(function(){layer.trigger("showend")},_.config.speed)},50)},hide:function(layer){var config=layer.config,$le=layer.$element;$le.find("*").trigger("blur",[true]);layer.trigger("hidestart");$le._skel_layers_translateOrigin();window.setTimeout(function(){if(config.exclusive)_.unlockView("x");layer.moveToHiddenWrapper();$le._skel_layers_demote().hide();layer.trigger("hideend")},_.config.speed+50)}},overlayY:{show:function(layer){var config=layer.config,$le=layer.$element;$le.scrollTop(0)._skel_layers_promote(config.zIndex).css(config.side,"-"+_.recalcW(config._height)+"px").show();if(config.resetForms)$le._skel_layers_resetForms();if(config.exclusive)_.lockView("y");layer.moveToVisibleWrapper();layer.trigger("showstart");window.setTimeout(function(){$le._skel_layers_translate(0,(config.side=="bottom"?"-":"")+_.recalcW(config._height));window.setTimeout(function(){layer.trigger("showend")},_.config.speed)},50)},hide:function(layer){var config=layer.config,$le=layer.$element;$le.find("*").trigger("blur",[true]);layer.trigger("hidestart");$le._skel_layers_translateOrigin();window.setTimeout(function(){if(config.exclusive)_.unlockView("y");layer.moveToHiddenWrapper();$le._skel_layers_demote().hide();layer.trigger("hideend")},_.config.speed+50)}},pushX:{show:function(layer){var config=layer.config,$le=layer.$element,$w=_.cache.wrapper.add(_.cache.visibleWrapper.children());$le.scrollTop(0).css(config.side,"-"+_.recalcW(config._width)+"px").show();if(config.resetForms)$le._skel_layers_resetForms();$w._skel_layers_promote();if(config.exclusive)_.lockView("x");layer.moveToVisibleWrapper();layer.trigger("showstart");window.setTimeout(function(){$le.add($w)._skel_layers_translate((config.side=="right"?"-":"")+_.recalcW(config._width),0);window.setTimeout(function(){layer.trigger("showend")},_.config.speed)},50)},hide:function(layer){var config=layer.config,$le=layer.$element,$w=_.cache.wrapper.add(_.cache.visibleWrapper.children());$le.find("*").trigger("blur",[true]);layer.trigger("hidestart");$le.add($w)._skel_layers_translateOrigin();window.setTimeout(function(){if(config.exclusive)_.unlockView("x");$le.hide();layer.moveToHiddenWrapper();$w._skel_layers_demote();layer.trigger("hideend")},_.config.speed+50)}},pushY:{show:function(layer){var config=layer.config,$le=layer.$element,$w=_.cache.wrapper.add(_.cache.visibleWrapper.children());$le.scrollTop(0).css(config.side,"-"+_.recalcH(config._height)+"px").show();if(config.resetForms)$le._skel_layers_resetForms();if(config.exclusive)_.lockView("y");layer.moveToVisibleWrapper();layer.trigger("showstart");window.setTimeout(function(){$le.add($w)._skel_layers_translate(0,(config.side=="bottom"?"-":"")+_.recalcH(config._height));window.setTimeout(function(){layer.trigger("showend")},_.config.speed)},50)},hide:function(layer){var config=layer.config,$le=layer.$element,$w=_.cache.wrapper.add(_.cache.visibleWrapper.children());$le.find("*").trigger("blur",[true]);layer.trigger("hidestart");$le.add($w)._skel_layers_translateOrigin();window.setTimeout(function(){if(config.exclusive)_.unlockView("y");$le.hide();layer.moveToHiddenWrapper();layer.trigger("hideend")},_.config.speed+50)}},revealX:{show:function(layer){var config=layer.config,$le=layer.$element,$w=_.cache.wrapper.add(_.cache.visibleWrapper.children());$le.scrollTop(0).show();if(config.resetForms)$le._skel_layers_resetForms();$w._skel_layers_promote();if(config.exclusive)_.lockView("x");layer.moveToVisibleWrapper();layer.trigger("showstart");window.setTimeout(function(){$w._skel_layers_translate((config.side=="right"?"-":"")+_.recalcW(config._width),0);window.setTimeout(function(){layer.trigger("showend")},_.config.speed)},50)},hide:function(layer){var config=layer.config,$le=layer.$element,$w=_.cache.wrapper.add(_.cache.visibleWrapper.children());$le.find("*").trigger("blur",[true]);layer.trigger("hidestart");$w._skel_layers_translateOrigin();window.setTimeout(function(){if(config.exclusive)_.unlockView("x");$le.hide();$w._skel_layers_demote();layer.moveToHiddenWrapper();layer.trigger("hideend")},_.config.speed+50)}}};Layer.prototype.positions={"top-left":{v:"top",h:"left",side:"left"},"top-right":{v:"top",h:"right",side:"right"},top:{v:"top",h:"center",side:"top"},"top-center":{v:"top",h:"center",side:"top"},"bottom-left":{v:"bottom",h:"left",side:"left"},"bottom-right":{v:"bottom",h:"right",side:"right"},bottom:{v:"bottom",h:"center",side:"bottom"},"bottom-center":{v:"bottom",h:"center",side:"bottom"},left:{v:"center",h:"left",side:"left"},"center-left":{v:"center",h:"left",side:"left"},right:{v:"center",h:"right",side:"right"},"center-right":{v:"center",h:"right",side:"right"},center:{v:"center",h:"center",side:false},"center-center":{v:"center",h:"center",side:false}};Layer.prototype.on=function(name,f){if(!this.events[name])this.events[name]=[];this.events[name].push(f)};Layer.prototype.trigger=function(name){if(!this.events[name]||this.events[name].length==0)return;var k,_this=this;_._.iterate(this.events[name],function(k){_this.events[name][k]()})};Layer.prototype.show=function(instant){if(this.visible){_.cache.visibleWrapper.append(this.element);return}console.log("[skel-layers] "+this.id+": showing");var _this=this,config=this.config,animation=_._.useActive(config.animation),$le=this.$element,x;$le.css("max-width","").css("max-height","").css("width","").css("height","");config._width=_._.useActive(config.width);config._height=_._.useActive(config.height);if(config._width=="auto")config._width=$le.outerWidth()+1;if(config._height=="auto")config._height=$le.outerHeight()+1;if(config.maxWidth!="100%"||config.width=="auto"){config._width=_.recalcW(config._width);config._maxWidth=_.recalcW(_._.useActive(config.maxWidth));config._width=Math.min(config._width,config._maxWidth)}if(config.maxHeight!="100%"||config.height=="auto"){config._height=_.recalcH(config._height);config._maxHeight=_.recalcH(_._.useActive(config.maxHeight));config._height=Math.min(config._height,config._maxHeight)}$le.css("width",config._width).css("height",config._height);if(_._.vars.deviceType=="ios"){if(config._height=="100%"&&!config.hidden)$le.css("height","-webkit-calc("+config._height+" + 70px)");$le.on("blur","input,select,textarea",function(event,ignore){if(ignore)return;window.setTimeout(function(){_.cache.hiddenWrapper.append(_this.element);window.setTimeout(function(){_.cache.visibleWrapper.append(_this.element)},500)},500)})}x=this.positions[config.position];$le.addClass("skel-layer-"+config.position).data("skel-layers-layer-position",config.position);switch(x.v){case"top":$le.css("top",0);break;case"bottom":$le.css("bottom",0);break;case"center":$le.css("top","50%").css("margin-top","-"+_.getHalf(config._height));break}switch(x.h){case"left":$le.css("left",0);break;case"right":$le.css("right",0);break;case"center":$le.css("left","50%").css("margin-left","-"+_.getHalf(config._width));break}this.animations[animation].show(this);if(config.exclusive){_.cache.body.addClass("skel-layers-exclusiveVisible");_.cache.exclusiveLayer=this}this.visible=true;this.trigger("show")};Layer.prototype.hide=function(instant){if(!this.visible){_.cache.hiddenWrapper.append(this.element);return}console.log("[skel-layers] "+this.id+": hiding");var config=this.config,animation=_._.useActive(config.animation);if(!(animation in this.animations))animation="none";this.animations[animation].hide(this);if(config.exclusive&&_.cache.exclusiveLayer===this){_.cache.body.removeClass("skel-layers-exclusiveVisible");_.cache.exclusiveLayer=null}this.trigger("hide");this.visible=false};Layer.prototype.init=function(){var config=this.config,$le=$(this.element),_this=this,x;$le._skel_layers_init();$le.find("*").each(function(){_.parseInit($(this))});$le.addClass("skel-layer").data("skel-layers-layer-index",this.index).css("z-index",_.config.baseZIndex).css("position","fixed").css("-ms-overflow-style","-ms-autohiding-scrollbar").css("-webkit-overflow-scrolling","touch").hide();switch(config.orientation){case"vertical":$le.css("overflow-y","auto").css("overflow-x","hidden");break;case"horizontal":$le.css("overflow-x","auto").css("overflow-y","hidden");break;case"none":default:break}if(!config.position||!(config.position in this.positions))config.position="top-left";if(!config.side)config.side=this.positions[config.position].side;if(!config.animation||typeof config.animation!=="object"&&!(config.animation in this.animations))config.animation="none";if(config.clickToHide)$le.find("a").css("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("click.skel-layers",function(event){var t=$(this);if(t.hasClass("skel-layers-ignore"))return;event.preventDefault();event.stopPropagation();_this.hide();if(t.hasClass("skel-layers-ignoreHref"))return;var href=t.attr("href"),target=t.attr("target");if(typeof href!=="undefined"&&href!=""){window.setTimeout(function(){if(target=="_blank"&&_._.vars.deviceType!="wp")window.open(href);else window.location.href=href},_.config.speed+10)}});$le.on("touchstart",function(e){_this.touchPosX=e.originalEvent.touches[0].pageX;_this.touchPosY=e.originalEvent.touches[0].pageY}).on("touchmove",function(e){if(_this.touchPosX===null||_this.touchPosY===null)return;var diffX=_this.touchPosX-e.originalEvent.touches[0].pageX,diffY=_this.touchPosY-e.originalEvent.touches[0].pageY,th=$le.outerHeight(),ts=$le.get(0).scrollHeight-$le.scrollTop();if(config.hidden&&config.swipeToHide){var result=false,boundary=20,delta=50;switch(config.side){case"left":result=diffY<boundary&&diffY>-1*boundary&&diffX>delta;break;case"right":result=diffY<boundary&&diffY>-1*boundary&&diffX<-1*delta;break;case"top":result=diffX<boundary&&diffX>-1*boundary&&diffY>delta;break;case"bottom":result=diffX<boundary&&diffX>-1*boundary&&diffY<-1*delta;break}if(result){_this.touchPosX=null;_this.touchPosY=null;_this.hide();return false}}if($le.scrollTop()==0&&diffY<0||ts>th-2&&ts<th+2&&diffY>0)return false});this.$element=$le;console.log("[skel-layers] "+this.id+": layer initialized!")};Layer.prototype.isInitialized=function(){return this.$element!==null};Layer.prototype.isVisible=function(){return this.$element.is(":visible")};Layer.prototype.moveToVisibleWrapper=function(){_.cache.visibleWrapper.append(this.$element)};Layer.prototype.moveToHiddenWrapper=function(){if(!this.$element._skel_layers_hasParent())return;_.cache.hiddenWrapper.append(this.$element)};Layer.prototype.resume=function(instant){if(!this.isInitialized())return;this.$element.find("*").each(function(){_.parseResume($(this))});if(!this.config.hidden)this.show(instant);console.log("[skel-layers] "+this.id+": layer resumed")};Layer.prototype.suspend=function(){if(!this.isInitialized())return;this.$element._skel_layers_translateOrigin();this.$element.find("*").each(function(){_.parseSuspend($(this))});if(this.visible)this.hide();console.log("[skel-layers] "+this.id+": layer suspended")};var _={cache:{visibleWrapper:null,body:null,exclusiveLayer:null,document:null,html:null,htmlbody:null,hiddenWrapper:null,layers:{},parent:null,window:null,wrapper:null},config:{baseZIndex:1e4,layers:{},mode:"position",speed:500,easing:"ease",wrap:true},layerIndex:1,create:function(id,config,skipStateUpdate){var e,layer;if(id in _.cache.layers)return;if(!("position"in config))return;if(!config.html&&(e=$("#"+id)).length==0)return;if(!_.config.wrap){_.config.wrap=true;_.initWrappers()}layer=new Layer(id,config,_.layerIndex++);_.cache.layers[id]=layer;if(e){e.children().appendTo(layer.element);e.remove()}if(!skipStateUpdate)_._.updateState();return layer},destroy:function(id){if(!(id in _.cache.layers))return;var layer=_.cache.layers[id];layer.suspend();if(layer.config.states&&layer.config.states!=_._.sd){a=_._.getArray(layer.config.states);_._.iterate(a,function(i){_._.removeCachedElementFromState(a[i],id)})}if(layer.config.breakpoints){a=_._.getArray(layer.config.breakpoints);_._.iterate(a,function(i){_._.removeCachedElementFromBreakpoint(a[i],id)})}$(layer.element).remove();delete _.cache.layers[id];skel.uncacheElement(id);return true},get:function(id){if(!(id in _.cache.layers))return;return _.cache.layers[id]},hide:function(id){_.cache.layers[id].hide()},show:function(id){_.cache.layers[id].show()},toggle:function(id){var layer=_.cache.layers[id];if(layer.isVisible())layer.hide();else layer.show()},getBaseFontSize:function(){if(_._.vars.IEVersion<9)return 16.5;return parseFloat(getComputedStyle(_.cache.body.get(0)).fontSize)},getHalf:function(n){var i=parseInt(n);if(typeof n=="string"&&n.charAt(n.length-1)=="%")return Math.floor(i/2)+"%";return Math.floor(i/2)+"px"},lockView:function(a){if(a=="x")_.cache.htmlbody.css("overflow-x","hidden");if(_.config.mode!="transform"&&skel.vars.deviceType=="ios")_.cache.parent.css("height",_.cache.document.height());_.cache.wrapper.on("touchstart.lock click.lock scroll.lock",function(e){e.preventDefault();e.stopPropagation();if(_.cache.exclusiveLayer)_.cache.exclusiveLayer.hide()});_.cache.window.on("orientationchange.lock",function(e){if(_.cache.exclusiveLayer)_.cache.exclusiveLayer.hide()});if(!_._.vars.isMobile)window.setTimeout(function(){_.cache.window.on("resize.lock scroll.lock",function(e){if(_.cache.exclusiveLayer)_.cache.exclusiveLayer.hide()})},_.config.speed+50)},parseInit:function(x){var a,b;var o=x.get(0),action=x.attr("data-action"),args=x.attr("data-args"),arg1,arg2;if(action&&args)args=args.split(",");switch(action){case"toggleLayer":case"layerToggle":x.css("-webkit-tap-highlight-color","rgba(0,0,0,0)").css("cursor","pointer").on("touchend click",function(event){var $this=$(this);event.preventDefault();event.stopPropagation();if($this.data("skel-layers-handled")===true)return;$this.data("skel-layers-handled",true);window.setTimeout(function(){$this.removeData("skel-layers-handled")},500);if(_.cache.exclusiveLayer){_.cache.exclusiveLayer.hide();return false}var layer=_.cache.layers[args[0]];if(layer.isVisible())layer.hide();else layer.show()});break;case"navList":arg1=$("#"+args[0]);a=arg1.find("a");b=[];a.each(function(){var t=$(this),indent,href;indent=Math.max(0,t.parents("li").length-1);href=t.attr("href");b.push('<a class="link depth-'+indent+'"'+(typeof href!=="undefined"&&href!=""?' href="'+href+'"':"")+'><span class="indent-'+indent+'"></span>'+t.text()+"</a>")});if(b.length>0)x.html("<nav>"+b.join("")+"</nav>");break;case"copyText":arg1=$("#"+args[0]);x.html(arg1.text());break;case"copyHTML":arg1=$("#"+args[0]);x.html(arg1.html());break;case"moveElementContents":arg1=$("#"+args[0]);o._skel_layers_resume=function(){arg1.children().each(function(){var t=$(this);if(t.hasClass("skel-layers-moved"))return;x.append(t);t.addClass("skel-layers-moved");t._skel_layers_uncss()})};o._skel_layers_suspend=function(){x.children().each(function(){var t=$(this);if(!t.hasClass("skel-layers-moved"))return;arg1.append(t);t.removeClass("skel-layers-moved");_.refresh(t);t._skel_layers_recss()})};o._skel_layers_resume();break;case"moveElement":arg1=$("#"+args[0]);o._skel_layers_resume=function(){if(arg1.hasClass("skel-layers-moved"))return;$('<div id="skel-layers-placeholder-'+arg1.attr("id")+'" />').insertBefore(arg1);x.append(arg1);arg1.addClass("skel-layers-moved");arg1._skel_layers_uncss()};o._skel_layers_suspend=function(){if(!arg1.hasClass("skel-layers-moved"))return;$("#skel-layers-placeholder-"+arg1.attr("id")).replaceWith(arg1);arg1.removeClass("skel-layers-moved");_.refresh(arg1);arg1._skel_layers_recss()};o._skel_layers_resume();break;case"moveCell":arg1=$("#"+args[0]);arg2=$("#"+args[1]);o._skel_layers_resume=function(){$('<div id="skel-layers-placeholder-'+arg1.attr("id")+'" />').insertBefore(arg1);x.append(arg1);arg1.css("width","auto");if(arg2)arg2._skel_layers_expandCell()};o._skel_layers_suspend=function(){$("#skel-layers-placeholder-"+arg1.attr("id")).replaceWith(arg1);arg1.css("width","");if(arg2)arg2.css("width","")};o._skel_layers_resume();break;default:break}},parseResume:function(x){var o=x.get(0);if(o._skel_layers_resume)o._skel_layers_resume()},parseSuspend:function(x){var o=x.get(0);if(o._skel_layers_suspend)o._skel_layers_suspend()},recalc:function(n,context){var x=_._.parseMeasurement(n),y;switch(x[1]){case"%":y=Math.floor(context*(x[0]/100));break;case"em":y=_.getBaseFontSize()*x[0];break;default:case"px":y=x[0];break}return y},recalcH:function(n){return _.recalc(n,$(window).height())},recalcW:function(n){return _.recalc(n,$(window).width())},refresh:function(target){var x;if(target)x=target.filter(".skel-layers-fixed:not(.skel-layers-moved)");else x=$(".skel-layers-fixed:not(.skel-layers-moved)");x._skel_layers_init(true).appendTo(_.cache.visibleWrapper)},unlockView:function(a){if(a=="x")_.cache.htmlbody.css("overflow-x","");if(_.config.mode!="transform"&&skel.vars.deviceType=="ios")_.cache.parent.css("height","");_.cache.wrapper.off("touchstart.lock click.lock scroll.lock");_.cache.window.off("orientationchange.lock");if(!_._.vars.isMobile)_.cache.window.off("resize.lock scroll.lock")},init:function(){if("config"in _.config){_._.extend(_.config,_.config.config);delete _.config.config}_._.iterate(_.config,function(k){if(_.config[k]&&typeof _.config[k]=="object"&&"position"in _.config[k]){_.config.layers[k]=_.config[k];delete _.config[k]}});if(typeof _.config.mode=="function")_.config.mode=_.config.mode();if(_.config.mode=="transform"&&(!_._.canUseProperty("transform")||!_._.canUseProperty("transition")))_.config.mode="position";if(_.config.mode=="position"&&!_._.canUseProperty("transition"))_.config.mode="animate";if(_._.vars.deviceType=="wp")_.config.mode="animate";_.cache.window=$(window);$(function(){_.initAnimation();_.initObjects();if(_.config.wrap)_.initWrappers();_.initLayers();_.initIncludes();_._.updateState()})},initIncludes:function(){$(".skel-layers-include").each(function(){_.parseInit($(this))})},initLayers:function(){_._.iterate(_.config.layers,function(id){_.create(id,_.config.layers[id],true)})},initObjects:function(){_.cache.document=$(document);_.cache.html=$("html");_.cache.body=$("body");_.cache.htmlbody=$("html,body")},initAnimation:function(){if(_.config.mode=="animate"){$.fn._skel_layers_fadeIn=function(f){$(this).fadeTo(_.config.speed,1,f)};$.fn._skel_layers_fadeOut=function(f){$(this).fadeTo(_.config.speed,0,f)}}else{$.fn._skel_layers_fadeIn=function(f){$(this).css("opacity",1);if(f)window.setTimeout(f,_.config.speed+50)};$.fn._skel_layers_fadeOut=function(f){$(this).css("opacity",0);if(f)window.setTimeout(f,_.config.speed+50)}}if(_.config.mode=="transform"){$.fn._skel_layers_translateOrigin=function(){return $(this)._skel_layers_translate(0,0)};$.fn._skel_layers_translate=function(x,y){return $(this).css("transform","translate("+x+"px, "+y+"px)")};$.fn._skel_layers_init=function(){return $(this).css("backface-visibility","hidden").css("perspective","500")._skel_layers_xcss("transition","transform "+_.config.speed/1e3+"s "+_.config.easing+","+"opacity "+_.config.speed/1e3+"s "+_.config.easing).data("skel-layers-css",["backface-visibility","perspective","-moz-transition","-webkit-transition","-o-transition","-ms-transition","transition"])}}else{var origins=[];if(_.config.mode=="animate"){_.cache.window.resize(function(){if(_.config.speed!=0){var t=_.config.speed;_.config.speed=0;window.setTimeout(function(){_.config.speed=t;origins=[]},0)}});if(_.config.easing.substr(0,4)=="ease"){_.config.easing="swing";_.config.speed=_.config.speed*.65}else _.config.easing="linear";$.fn._skel_layers_doTranslate=function(a,f){$(this).animate(a,_.config.speed,_.config.easing,f)};$.fn._skel_layers_init=function(fixed){return $(this).css("position",fixed?"fixed":"absolute").data("skel-layers-css",["position"])}}else{_.cache.window.resize(function(){window.setTimeout(function(){origins=[]},0)});$.fn._skel_layers_doTranslate=function(a,f){var t=$(this);_._.iterate(a,function(k){t.css(k,a[k])});window.setTimeout(f,_.config.speed)};$.fn._skel_layers_init=function(fixed){return $(this).css("transition","top "+_.config.speed/1e3+"s "+_.config.easing+","+"right "+_.config.speed/1e3+"s "+_.config.easing+","+"bottom "+_.config.speed/1e3+"s "+_.config.easing+","+"left "+_.config.speed/1e3+"s "+_.config.easing+","+"opacity "+_.config.speed/1e3+"s "+_.config.easing).css("position",fixed?"fixed":"absolute").data("skel-layers-css",["-moz-transition","-webkit-transition","-o-transition","-ms-transition","transition","position"])}}$._skel_layers_cssNumericValue=function(x){if(x&&x.slice(-1)=="%")return x;return parseInt(x)};$.fn._skel_layers_translateOrigin=function(){for(var i=0;i<this.length;i++){var e=this[i],t=$(e);if(origins[e.id]){t._skel_layers_doTranslate(origins[e.id],function(){_._.iterate(origins[e.id],function(i){t.css(i,origins[e.id][i])});_.cache.parent.css("overflow-x","");_.cache.wrapper.css("width","auto").css("padding-bottom",0)})}}return $(this)};$.fn._skel_layers_translate=function(x,y){var i,j,fx,fy;x=parseInt(x);y=parseInt(y);if(x!=0){(skel.vars.deviceType=="ios"?_.cache.parent:_.cache.body).css("overflow-x","hidden");_.cache.wrapper.css("width",_.cache.window.width())}else{fx=function(){(skel.vars.deviceType=="ios"?_.cache.parent:_.cache.body).css("overflow-x","");_.cache.wrapper.css("width","auto")}}if(y<0)_.cache.wrapper.css("padding-bottom",Math.abs(y));else fy=function(){_.cache.wrapper.css("padding-bottom",0)};for(i=0;i<this.length;i++){var e=this[i],t=$(e),p;if(!origins[e.id]){if(p=Layer.prototype.positions[t.data("skel-layers-layer-position")]){origins[e.id]={};switch(p.v){case"center":case"top":origins[e.id].top=$._skel_layers_cssNumericValue(e.style.top);break;case"bottom":origins[e.id].bottom=$._skel_layers_cssNumericValue(e.style.bottom);break}switch(p.h){case"center":case"left":origins[e.id].left=$._skel_layers_cssNumericValue(e.style.left);break;case"right":origins[e.id].right=$._skel_layers_cssNumericValue(e.style.right);break}}else{p=t.position();origins[e.id]={top:p.top,left:p.left}}}a={};_._.iterate(origins[e.id],function(i){var v;switch(i){case"top":v=_.recalcH(origins[e.id][i])+y;break;case"bottom":v=_.recalcH(origins[e.id][i])-y;break;case"left":v=_.recalcW(origins[e.id][i])+x;break;case"right":v=_.recalcW(origins[e.id][i])-x;break}a[i]=v});t._skel_layers_doTranslate(a,function(){if(fx)fx();if(fy)fy()})}return $(this)}}},initWrappers:function(){if(_.config.mode!="transform"){_.cache.body.wrapInner('<div id="skel-layers-parent" />');_.cache.parent=$("#skel-layers-parent");_.cache.parent.css("position","absolute").css("left",0).css("top",0).css("min-height","100%").css("width","100%")}else _.cache.parent=_.cache.body;_.cache.parent.wrapInner('<div id="skel-layers-wrapper" />');_.cache.wrapper=$("#skel-layers-wrapper");_.cache.wrapper.css("position","relative").css("left",0).css("right",0).css("top",0)._skel_layers_init();_.cache.hiddenWrapper=$('<div id="skel-layers-hiddenWrapper" />').appendTo(_.cache.parent);_.cache.hiddenWrapper.css("height","100%");_.cache.visibleWrapper=$('<div id="skel-layers-visibleWrapper" />').appendTo(_.cache.parent);_.cache.visibleWrapper.css("position","relative");_._.registerLocation("skel_layers_hiddenWrapper",_.cache.hiddenWrapper[0]);_._.registerLocation("skel_layers_visibleWrapper",_.cache.visibleWrapper[0]);_._.registerLocation("skel_layers_wrapper",_.cache.wrapper[0]);$("[autofocus]").focus();_.refresh()}};return _}(jQuery))});